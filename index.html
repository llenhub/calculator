<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Calculator</title>
    <style>
        :root { 
            --version: "1.2"; 
        }
        body { 
            font-family: 'Courier New', monospace; 
            display: flex; 
            height: 100vh; 
            background-color: #b0c4de; 
            overflow: hidden;
        } 
        .history-panel {
            width: 200px;
            background: #f5f5f5;
            border-right: 4px solid #aaa;
            padding: 10px;
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
        }
        .history-entry {
            font-size: 14px;
            padding: 5px 0;
        }
        .combo {
            font-size: 16px;
            font-weight: bold;
            color: red;
            margin-top: 10px;
        }
        .calculator { 
            background: #d3d3d3; 
            padding: 10px; 
            border: 4px solid #aaa; 
            box-shadow: inset -3px -3px 5px rgba(0, 0, 0, 0.2), inset 3px 3px 5px rgba(255, 255, 255, 0.4); 
            width: 270px; 
            text-align: center; 
        } 
        .display { 
            width: 90%; 
            height: 40px; 
            padding: 10px; 
            font-size: 24px; 
            font-weight: bold; 
            text-align: right; 
            background: #e0e0e0; 
            border: inset 3px #aaa; 
            color: #222; 
            font-family: 'Courier New', monospace; 
            margin-bottom: 10px; 
            overflow: hidden; 
            white-space: nowrap; 
        } 
        .buttons { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 5px; 
        } 
        button { 
            padding: 10px; 
            font-size: 18px; 
            font-weight: bold; 
            border: 2px solid #aaa; 
            cursor: pointer; 
        }
    </style> 
</head> 
<body> 
    <div class="history-panel" id="history-panel"></div>
    <div class="calculator"> 
        <input type="text" id="display" class="display" disabled> 
        <div class="buttons"> 
            <button onclick="clearDisplay()">CE</button> 
            <button class="operator" onclick="toggleSign()">Â±</button> 
            <button class="operator" onclick="appendToDisplay('%')">%</button> 
            <button class="operator" onclick="appendToDisplay('/')">/</button> 
            <button class="operator" onclick="appendToDisplay('*')">X</button> 

            <button onclick="appendToDisplay('7')">7</button> 
            <button onclick="appendToDisplay('8')">8</button> 
            <button onclick="appendToDisplay('9')">9</button> 
            <button class="operator" onclick="appendToDisplay('-')">-</button> 
            <button class="operator" onclick="appendToDisplay('+')">+</button> 

            <button onclick="appendToDisplay('4')">4</button> 
            <button onclick="appendToDisplay('5')">5</button> 
            <button onclick="appendToDisplay('6')">6</button> 
            <button onclick="calculateResult()">=</button> 

            <button onclick="appendToDisplay('1')">1</button> 
            <button onclick="appendToDisplay('2')">2</button> 
            <button onclick="appendToDisplay('3')">3</button> 
            <button onclick="appendToDisplay('0')">0</button> 
            <button onclick="appendToDisplay('.')">.</button> 
        </div> 
        <div class="combo" id="combo">Combo: 0</div>
    </div> 
 
    <script> 
        let comboCount = 0;
        let comboTimer;
        let expression = "";

        function appendToDisplay(value) { 
            expression += value;
            updateDisplay();
            updateHistory();
            increaseCombo();
        } 
        
        function clearDisplay() { 
            expression = "";
            updateDisplay();
        } 
        
        function calculateResult() { 
            try { 
                let result = eval(expression);
                expression = result.toString();
                updateHistory(result);
            } catch { 
                expression = "Error";
            } 
            updateDisplay();
        } 
        
        function toggleSign() {
            if (expression) {
                if (expression.startsWith("-")) {
                    expression = expression.slice(1);
                } else {
                    expression = "-" + expression;
                }
            }
            updateDisplay();
        }

        function updateDisplay() {
            let parts = expression.match(/(\d+)([+\-*/%])?(\d*)/);
            if (parts) {
                document.getElementById("display").value = parts[1] + (parts[2] || "") + (parts[3] || "");
            }
        }
        
        function updateHistory(result = "") {
            let history = document.getElementById("history-panel");
            let entry = document.createElement("div");
            entry.classList.add("history-entry");
            entry.textContent = expression + (result ? " = " + result : "");
            history.appendChild(entry);
            history.scrollLeft = history.scrollWidth;
        }

        function increaseCombo() {
            comboCount++;
            document.getElementById("combo").textContent = "Combo: " + comboCount;
            clearTimeout(comboTimer);
            comboTimer = setTimeout(() => comboCount = 0, 2000);
        }

        document.addEventListener("keydown", function(event) { 
            if (!isNaN(event.key) || "+-*/.%".includes(event.key)) { 
                appendToDisplay(event.key);
            } else if (event.key === "Enter") {
                calculateResult();
            } else if (event.key === "Backspace") {
                clearDisplay();
            }
        });
    </script>
</body>
</html>
